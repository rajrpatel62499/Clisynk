<div class="day-detail-container">
    <div class="flex-wrapper">
        <div *ngFor="let data of allData;let i=index">
            <div class="day" *ngIf="data?.data?.length">
                <div class="day-label">{{data?._id}}</div>
                <div class="day-divider"></div>
            </div>
            <div class="day">
                <div class="day-label hidden">Jul 15</div>
                <div class="appts-list">
                    <div class="appt-list-item clickable">

                        <div class="appt" *ngFor="let val of data?.data;let j = index"
                             (click)="val.showDetail = true" (clickOutside)="val.showDetail = false">
                            <div class="popover-container">

                                <div class="popover-reference">
                                    <div class="appt-content">
                                        <div class="avatar">
                                            <div class="avatar default appoint-image">
                                                <div class="image">
                                                </div>
                                                <div class="letter">{{val?.contactId?.firstName | firstChar:val?.contactId?.lastName}}</div>
                                            </div>
                                        </div>
                                        <!--                                                    <div class="description is-past">-->
                                        <div class="description normal">
                                            <div> {{val?.appointmentId?.name}}
                                                with  {{val?.contactId?.firstName}} {{val?.contactId?.lastName}}
                                            </div>
                                            <div class="time">
                                                {{val?.startTime |time}} - {{val?.endTime |time}}
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <section class="popover open" *ngIf="val.showDetail">
                                    <div class="arrow" style="top: 151px;"></div>
                                    <div class="ds-card elevation-z1">
                                        <section class="ds-card-header">
                                            <button type="button" class="button icon-only"
                                                    (click)="val.showDetail = false">
                                                <img src="/assets/images/ic_close.svg"
                                                     class="ng-star-inserted">
                                            </button>
                                            <h4>{{val?.appointmentId?.name}}
                                                with  {{val?.contactId?.firstName}} {{val?.contactId?.lastName}}
                                            </h4>
                                        </section>
                                        <section class="ds-card-body">
                                            <section class="detail-row">

                                                <svg class="icon">
                                                    <svg xmlns="http://www.w3.org/2000/svg"
                                                         viewBox="0 0 24 24" id="clock">
                                                        <path d="M12 1c6.075 0 11 4.925 11 11s-4.925 11-11 11S1 18.075 1 12 5.925 1 12 1zm0 2a9 9 0 1 0 0 18 9 9 0 0 0 0-18zm0 2a1 1 0 0 1 1 1v5.382l3.447 1.724a1 1 0 1 1-.894 1.788l-4-2A1 1 0 0 1 11 12V6a1 1 0 0 1 1-1z"
                                                              fill-rule="evenodd"></path>
                                                    </svg>
                                                </svg>

                                                <div> {{val?.date | date:'EEE,MMM, dd yyyy'}}
                                                    <br> {{val?.startTime |time}}
                                                    - {{val?.endTime |time}} IST ({{val?.endTime - val?.startTime}} hrs)
                                                </div>
                                            </section>

                                            <section class="detail-row" *ngIf="val?.extrakey">
                                                <svg class="icon">
                                                    <svg xmlns="http://www.w3.org/2000/svg"
                                                         viewBox="0 0 24 24" id="location">
                                                        <path
                                                                d="M12 1a9 9 0 0 1 9 9c0 2.783-1.355 5.466-2.916 7.682-1.574 2.235-3.453 4.126-4.672 5.328a2.012 2.012 0 0 1-2.824 0c-1.219-1.203-3.097-3.093-4.672-5.328C4.356 15.466 3 12.783 3 10a9 9 0 0 1 9-9zm0 2a7 7 0 0 0-7 7c0 2.167 1.075 4.434 2.551 6.53 1.464 2.077 3.23 3.861 4.442 5.057l.001.001.003.001h.006a.009.009 0 0 0 .004-.002c1.212-1.196 2.978-2.98 4.442-5.057C17.925 14.434 19 12.167 19 10a7 7 0 0 0-7-7zm0 3a4 4 0 1 1 0 8 4 4 0 0 1 0-8zm0 2a2 2 0 1 0 0 4 2 2 0 0 0 0-4z"
                                                                fill-rule="evenodd"></path>
                                                    </svg>
                                                </svg>
                                                <span class="location"
                                                      style="word-break: break-all;
                                                      padding: 8px 16px 8px 17px !important;margin-top: -8px !important;">
                                                    {{val?.extrakey}}</span>
                                            </section>
                                            <!--                                                        <section class="detail-row">-->
                                            <!--                                                            <svg class="icon">-->
                                            <!--                                                                <svg xmlns="http://www.w3.org/2000/svg"-->
                                            <!--                                                                     viewBox="0 0 24 24" id="note">-->
                                            <!--                                                                    <path-->
                                            <!--                                                                            d="M14.086 1a2 2 0 0 1 1.414.586L19.414 5.5A2 2 0 0 1 20 6.914V21a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2zM13 3H6v18h12V8h-4a1 1 0 0 1-.993-.883L13 7zm2.5 14a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1zm0-3a.5.5 0 0 1 0 1h-7a.5.5 0 0 1 0-1zm-4-5a.5.5 0 0 1 .09.992L11.5 10h-3a.5.5 0 0 1-.09-.992L8.5 9zM15 3.914V6h2.086z"-->
                                            <!--                                                                            fill-rule="evenodd"></path>-->
                                            <!--                                                                </svg>-->
                                            <!--                                                            </svg>-->
                                            <!--                                                            fgfgg-->
                                            <!--                                                        </section>-->
                                            <section class="detail-row">
                                                <svg class="icon">
                                                    <svg xmlns="http://www.w3.org/2000/svg"
                                                         viewBox="0 0 24 24" id="user">
                                                        <path
                                                                d="M19 14a2 2 0 0 1 2 2v4a1 1 0 1 1-2 0v-4H5v4a1 1 0 1 1-2 0v-4a2 2 0 0 1 2-2zM12 2a5 5 0 1 1 0 10 5 5 0 0 1 0-10zm0 2a3 3 0 1 0 0 6 3 3 0 0 0 0-6z"
                                                                fill-rule="evenodd"></path>
                                                    </svg>
                                                </svg>
                                                <div>
                                                    <a (click)="openContactDetails(val)">{{val?.contactId?.firstName}} {{val?.contactId?.lastName}}</a>
                                                </div>
                                            </section>
                                        </section>
                                        <section class="ds-card-footer">
                                            <div class="appointment-actions">

                                                <button type="button" class="money-btn"
                                                        (click)="appoint.reschedule(val)">
                                                    <svg class="icon">
                                                        <svg id="calendar" viewBox="0 0 24 24"
                                                             xmlns="http://www.w3.org/2000/svg">
                                                            <path
                                                                    d="M16 1a1 1 0 0 1 1 1v1h3a2 2 0 0 1 2 2v15a3 3 0 0 1-3 3H5a3 3 0 0 1-3-3V5a2 2 0 0 1 2-2h3V2a1 1 0 0 1 2 0v1h6V2a1 1 0 0 1 1-1zm4 10H4v9a1 1 0 0 0 1 1h14a1 1 0 0 0 1-1zM7 5H4v4h16V5h-3v1a1 1 0 1 1-2 0V5H9v1a1 1 0 0 1-2 0z"
                                                                    fill-rule="evenodd"></path>
                                                        </svg>
                                                    </svg>
                                                    <span>Reschedule</span>
                                                </button>

                                                <button type="button" class="btn-outline-danger"
                                                        (click)="cancelAppointment(val,i,j)">
                                                    <svg class="icon">
                                                        <svg xmlns="http://www.w3.org/2000/svg"
                                                             viewBox="0 0 24 24" id="calendar-x">
                                                            <path
                                                                    d="M16 1a1 1 0 0 1 .993.883L17 2v1h3a2 2 0 0 1 1.995 1.85L22 5v7a1 1 0 0 1-1.993.117L20 12v-1H4v9a1 1 0 0 0 .883.993L5 21h7a1 1 0 0 1 .117 1.993L12 23H5a3 3 0 0 1-2.995-2.824L2 20V5a2 2 0 0 1 1.85-1.995L4 3h3V2a1 1 0 0 1 1.993-.117L9 2v1h6V2a1 1 0 0 1 1-1zm-.707 14.293a1 1 0 0 1 1.414 0L19 17.586l2.293-2.293a1 1 0 0 1 1.414 1.414L20.414 19l2.293 2.293a1 1 0 0 1-1.414 1.414L19 20.414l-2.293 2.293a1 1 0 0 1-1.414-1.414L17.586 19l-2.293-2.293a1 1 0 0 1 0-1.414zM7 5H4v4h16V5h-3v1a1 1 0 1 1-2 0V5H9v1a1 1 0 0 1-2 0z"
                                                                    fill-rule="evenodd"></path>
                                                        </svg>
                                                    </svg>
                                                    <span>Cancel appointment</span>
                                                </button>
                                            </div>
                                        </section>
                                    </div>
                                </section>

                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
